(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("vue")):"function"===typeof define&&define.amd?define([],t):"object"===typeof exports?exports["LatticeLottery"]=t(require("vue")):e["LatticeLottery"]=t(e["Vue"])})("undefined"!==typeof self?self:this,(function(e){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="f2a0")}({1902:function(e,t,n){},"22a7":function(e,t,n){},3607:function(e,t,n){"use strict";n("22a7")},"395b":function(e,t,n){},4296:function(e,t,n){},"56e2":function(e,t,n){},"79e4":function(e,t,n){var i,o,l;(function(n,c){o=[],i=c,l="function"===typeof i?i.apply(t,o):i,void 0===l||(e.exports=l)})("undefined"!==typeof self&&self,(function(){function e(){var t=Object.getOwnPropertyDescriptor(document,"currentScript");if(!t&&"currentScript"in document&&document.currentScript)return document.currentScript;if(t&&t.get!==e&&document.currentScript)return document.currentScript;try{throw new Error}catch(b){var n,i,o,l=/.*at [^(]*\((.*):(.+):(.+)\)$/gi,c=/@([^@]*):(\d+):(\d+)\s*$/gi,r=l.exec(b.stack)||c.exec(b.stack),s=r&&r[1]||!1,a=r&&r[2]||!1,u=document.location.href.replace(document.location.hash,""),d=document.getElementsByTagName("script");s===u&&(n=document.documentElement.outerHTML,i=new RegExp("(?:[^\\n]+?\\n){0,"+(a-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),o=n.replace(i,"$1").trim());for(var m=0;m<d.length;m++){if("interactive"===d[m].readyState)return d[m];if(d[m].src===s)return d[m];if(s===u&&d[m].innerHTML&&d[m].innerHTML.trim()===o)return d[m]}return null}}return e}))},"8bbf":function(t,n){t.exports=e},"8cb2":function(e,t,n){"use strict";n("a8e5")},a8e5:function(e,t,n){},b3f2:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=(e,t)=>{const n=e.__vccOpts||e;for(const[i,o]of t)n[i]=o;return n}},b91c:function(e,t,n){"use strict";n("e12d")},cf50:function(e,t,n){"use strict";n("1902")},d7f9:function(e,t,n){"use strict";n("56e2")},e12d:function(e,t,n){},f07b:function(e,t,n){"use strict";n("395b")},f2a0:function(e,t,n){"use strict";if(n.r(t),n.d(t,"LotteryGrid",(function(){return E})),n.d(t,"LotteryList",(function(){return A})),n.d(t,"SlotMachine",(function(){return U})),n.d(t,"Turntable",(function(){return se})),"undefined"!==typeof window){var i=window.document.currentScript,o=n("79e4");i=o(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:o});var l=i&&i.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);l&&(n.p=l[1])}var c=n("8bbf");const r={class:"lottery__box--grid"},s={class:"lattice__lottery__box"},a={class:"lottery__row"},u={class:"lottery__row right"},d={class:"lottery__row right"};function m(e,t,n,i,o,l){const m=Object(c["resolveComponent"])("lottery-item"),b=Object(c["resolveComponent"])("lottery-go");return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",r,[Object(c["createElementVNode"])("div",s,[Object(c["createElementVNode"])("div",a,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(l.luckyList.slice(0,3),(t,n)=>(Object(c["openBlock"])(),Object(c["createBlock"])(m,{isAct:n===e.listIndex,image:t.image,key:n,label:t.label},null,8,["isAct","image","label"]))),128))]),Object(c["createElementVNode"])("div",u,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(l.luckyList.slice(3,4),(t,n)=>(Object(c["openBlock"])(),Object(c["createBlock"])(m,{isAct:n+3===e.listIndex,image:t.image,key:n+3,label:t.label},null,8,["isAct","image","label"]))),128)),Object(c["createVNode"])(b,{onOnClick:e.onsubmit,label:e.btnText},null,8,["onOnClick","label"]),(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(l.luckyList.slice(-1),(t,n)=>(Object(c["openBlock"])(),Object(c["createBlock"])(m,{isAct:n+7===e.listIndex,image:t.image,key:n+7,label:t.label},null,8,["isAct","image","label"]))),128))]),Object(c["createElementVNode"])("div",d,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(l.luckyList.slice(4,7),(t,n)=>(Object(c["openBlock"])(),Object(c["createBlock"])(m,{style:[{marginBottom:0}],isAct:n+4===e.listIndex,image:t.image,key:n+4,label:t.label},null,8,["isAct","image","label"]))),128))])])])}const b=["src"],h={key:1,class:"prize__item__mask"},g={key:2};function p(e,t,n,i,o,l){return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",{class:Object(c["normalizeClass"])(["prize__item","lattice__lottery__item",n.isAct?"lattice__lottery__actItem":""])},[n.image?(Object(c["openBlock"])(),Object(c["createElementBlock"])("img",{key:0,class:"prize__item__image",src:n.image,alt:""},null,8,b)):Object(c["createCommentVNode"])("",!0),n.isAct?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",h)):Object(c["createCommentVNode"])("",!0),n.label?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",g,Object(c["toDisplayString"])(n.label),1)):Object(c["createCommentVNode"])("",!0)],2)}var f={props:{isAct:{type:Boolean,default:!1},label:{type:String,default:""},image:{type:String}}},y=(n("3607"),n("b3f2")),O=n.n(y);const j=O()(f,[["render",p]]);var k=j;const _={key:0};function v(e,t,n,i,o,l){return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",{onClick:t[0]||(t[0]=(...e)=>l.onClick&&l.onClick(...e)),class:"lottery__button lattice__lottery__btn"},[n.label?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",_,Object(c["toDisplayString"])(n.label),1)):Object(c["createCommentVNode"])("",!0)])}var B={props:{label:{type:String,default:""}},methods:{onClick(){this.$emit("onClick")}}};n("8cb2");const x=O()(B,[["render",v]]);var M=x,L={data(){return{listIndex:null,luckyIndex:0,baseSpeed:300,speed:20,hasCircleTimes:0,hasMoveTimes:0,isMoving:!1}},props:{list:{type:Array,required:!0},circleTimes:{type:Number,default:3},velocity:{type:[String],default:"speed",validator:function(e){return-1!==["invariance","speed"].indexOf(e)}},btnText:{type:String,default:"抽奖"}},methods:{onsubmit(){this.$emit("onsubmit")},go(e){if(console.log("go"),this.isMoving)return console.error("您重复调用了go()函数"),void this.$emit("onerror",{index:e,message:"您重复调用了go()函数"});let t;return t=Number(e),isNaN(t)?(console.error("go()函数传入值应该为Number类型，请检查"),void this.$emit("onerror",{index:e,message:"go()函数传入值应该为Number类型，请检查"})):t<0||t>=this.luckyList.length?(console.error("go()函数传入值应该为在 [0-"+(this.luckyList.length-1)+"] 区间内，请检查"),void this.$emit("onerror",{index:e,message:"go()函数传入值应该为在 [0-"+(this.luckyList.length-1)+"] 区间内，请检查"})):(this.luckyIndex=t,this.hasCircleTimes=0,null===this.listIndex?this.listIndex=0:this.listIndex+=1,this.$emit("onstart"),this.start(this.baseSpeed),void(this.isMoving=!0))},start(e){"speed"===this.velocity&&(this.hasMoveTimes<5?e-=this.speed+10*this.hasMoveTimes:this.hasMoveTimes>8*this.circleTimes-7&&(e+=this.speed+10*(8*this.circleTimes-this.hasMoveTimes))),setTimeout(()=>{-1!==this.hasCircleTimes?(this.listIndex<this.luckyList.length-1?this.listIndex+=1:(this.listIndex=0,this.hasCircleTimes++),this.hasCircleTimes>=this.circleTimes&&(this.hasCircleTimes=-1),this.hasMoveTimes++,this.start(e)):this.listIndex<this.luckyIndex?(this.listIndex+=1,this.hasMoveTimes++,this.start(e)):(this.luckyList[this.luckyIndex]?(console.log("恭喜您获得："+this.luckyList[this.luckyIndex].label),this.$emit("onend",this.luckyList[this.luckyIndex])):(this.$emit("onerror",{index:this.luckyIndex,message:"go函数传入的索引值无法匹配奖品列表"}),this.listIndex=0,console.error("错误捕获，luckyIndex：",this.luckyIndex)),this.hasMoveTimes=0,this.isMoving=!1)},e)}}},S={name:"LotteryGrid",components:{lotteryItem:k,lotteryGo:M},mixins:[L],computed:{luckyList(){let e=[];if(this.list&&this.list.length){e=JSON.parse(JSON.stringify(this.list));let t=e.length;if(t<8)for(let n=0;n<8-t;n++)e.push({label:"谢谢参与",id:n+t+1,index:n+t});else t>8&&e.splice(8)}return e}}};n("cf50");const C=O()(S,[["render",m]]);var E=C;const w={class:"lottery__box--list"},N={class:"lottery__list lattice__lottery__box"},T={class:"lottery__btn"};function $(e,t,n,i,o,l){const r=Object(c["resolveComponent"])("lottery-item"),s=Object(c["resolveComponent"])("lottery-go");return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",w,[Object(c["createElementVNode"])("div",N,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(l.luckyList,(t,n)=>(Object(c["openBlock"])(),Object(c["createBlock"])(r,{isAct:n===e.listIndex,image:t.image,key:n,label:t.label,style:Object(c["normalizeStyle"])([{marginBottom:n>5&&0}])},null,8,["isAct","image","label","style"]))),128))]),Object(c["createElementVNode"])("div",T,[Object(c["createVNode"])(s,{onOnClick:e.onsubmit,label:e.btnText,class:"list"},null,8,["onOnClick","label"])])])}var I={name:"LotteryList",components:{lotteryItem:k,lotteryGo:M},mixins:[L],computed:{luckyList(){let e=[];return this.list&&this.list.length?e=JSON.parse(JSON.stringify(this.list)):console.error("入参 list 应该为数组"),e}}};n("b91c");const V=O()(I,[["render",$]]);var A=V;E.install=function(e){e.component(E.name,E)},A.install=function(e){e.component(A.name,A)};const z={key:0,class:"slotMachine"};function D(e,t,n,i,o,l){const r=Object(c["resolveComponent"])("col-ele");return n.list&&n.list.length>0?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",z,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(n.colCount,e=>(Object(c["openBlock"])(),Object(c["createBlock"])(r,{moveTime:n.moveTime,list:n.list,concatCount:n.concatCount,key:e,ref_for:!0,ref:"col"},null,8,["moveTime","list","concatCount"]))),128))])):Object(c["createCommentVNode"])("",!0)}const F={class:"slotMachine__col"},P={ref:"slotMachine__ul",class:"slotMachine__ul"},H=["src"],W={key:1,class:"slotMachine__label"},G={ref:"slotMachine__li",class:"slotMachine__li hide"};function q(e,t,n,i,o,l){return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",F,[Object(c["createElementVNode"])("div",P,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(l.cList,(e,t)=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",{class:"slotMachine__li",key:t},[e.image?(Object(c["openBlock"])(),Object(c["createElementBlock"])("img",{key:0,class:"slotMachine__image",src:e.image,alt:""},null,8,H)):Object(c["createCommentVNode"])("",!0),e.label?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",W,Object(c["toDisplayString"])(e.label),1)):Object(c["createCommentVNode"])("",!0)]))),128))],512),Object(c["createElementVNode"])("div",G,null,512)])}var J={name:"SlotMachineCol",props:{list:{type:Array,default(){return[]}},concatCount:{type:[String,Number],default:3},moveTime:{type:[String,Number],default:4}},data(){return{isMoving:!1,translateY:0}},computed:{cList(){const e=this.list||[];let t=[];if(e&&e.length>0)for(let n=0;n<this.concatCount;n++)t=t.concat(e);return t}},mounted(){const e=this.$refs.slotMachine__ul.clientHeight,t=this.$refs.slotMachine__li.clientHeight;this.$refs.slotMachine__ul.style=`transform: translateY(${-e+t}px);`},methods:{go(e){if(this.isMoving)return;this.isMoving=!0;const t=this.$refs.slotMachine__ul.clientHeight,n=this.$refs.slotMachine__li.clientHeight,i=t/this.concatCount,o=-i+(this.list.length-e)*n,l=["transition-property: transform",`transition-duration: ${this.moveTime}s`,"transition-timing-function: ease-in-out",`transform: translateY(${o}px)`];this.$refs.slotMachine__ul.style=l.join(";"),setTimeout(()=>{this.isMoving=!1;const i=-t+(this.list.length-e)*n;this.$refs.slotMachine__ul.style=`transform: translateY(${i}px);`},1e3*this.moveTime)}}};n("f07b");const Y=O()(J,[["render",q]]);var Z=Y;class R{constructor({code:e,data:t=null,msg:n}){console.error(n),this.code=e,this.data=t,this.msg=n}}var K={name:"SlotMachine",components:{ColEle:Z},props:{list:{type:Array,default(){return[]}},moveTime:{type:[String,Number],default:4},concatCount:{type:[String,Number],default:3},colCount:{type:[String,Number],default:3}},data(){return{isMoving:!1}},methods:{go(e){if("[object Array]"!==Object.prototype.toString.call(e))return void this.$emit("onerror",new R({code:1e3,msg:"go函数的传参类型应为 Array"}));if(e.length!==this.colCount)return void this.$emit("onerror",new R({code:1001,data:e,msg:`go函数的传参值长度（length：${e.length}） 不等于colCount值（colCount：${this.colCount}）`}));if(this.isMoving)return void this.$emit("onerror",new R({code:1002,msg:"重复调用go函数"}));this.isMoving=!0;const t=this.$refs.col;for(let n=0;n<t.length;n++)setTimeout(()=>{t[n].go(e[n]),n===t.length-1&&setTimeout(()=>{this.isMoving=!1,this.$emit("onend",e)},1e3*this.moveTime)},500*n)}}};n("f424");const Q=O()(K,[["render",D]]);var U=Q;U.install=function(e){e.component(U.name,U)};const X={class:"turntable"},ee={class:"turntable__prize__name"},te=["src"],ne={class:"turntable__lights"},ie=Object(c["createElementVNode"])("div",{class:"turntable__light__dot"},null,-1),oe=[ie];function le(e,t,n,i,o,l){return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",null,[Object(c["createElementVNode"])("div",X,[n.tableBg?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",{key:0,class:Object(c["normalizeClass"])("turntable__table"+(o.drawing?" move":"")),style:Object(c["normalizeStyle"])({transform:`rotate(${o.deg}deg)`,backgroundImage:`url('${n.tableBg}')`,width:n.width+"px",height:n.width+"px"})},null,6)):(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",{key:1,class:Object(c["normalizeClass"])(`turntable__container${o.drawing?" move":""}${l.listLength%2===1?" even":""}`),style:Object(c["normalizeStyle"])({transform:`rotate(${o.deg}deg)`,width:n.width+"px",height:n.width+"px"})},[Object(c["createElementVNode"])("div",{class:"turntable__content",style:Object(c["normalizeStyle"])({width:l.contentWidth+"px",height:l.contentWidth+"px"})},[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(n.list,(e,t)=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",{key:t,style:Object(c["normalizeStyle"])({transform:`rotateZ(${(t+1)*l.rotateDeg}deg)`,width:l.fanBladeWidth+"px"}),class:Object(c["normalizeClass"])("turntable__blade"+(l.listLength>2?" gt2Length":""))},[Object(c["createElementVNode"])("div",ee,Object(c["toDisplayString"])(e.label),1),Object(c["createElementVNode"])("img",{src:e.image,class:"turntable__prize__image",alt:""},null,8,te)],6))),128))],4),Object(c["createElementVNode"])("div",ne,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(n.list,(e,t)=>(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",{key:t,style:Object(c["normalizeStyle"])({transform:`rotateZ(${(t+1)*l.rotateDeg}deg)`}),class:"turntable__light"},oe,4))),128))])],6)),Object(c["createElementVNode"])("div",{class:"turntable__btn",onClick:t[0]||(t[0]=(...e)=>l.onDraw&&l.onDraw(...e))})])])}var ce={name:"Turntable",props:{tableBg:{type:String,default:""},list:{require:!0,type:Array,default:function(){return[]}},width:{type:[Number,String],default:340},skew:{type:Boolean,default:!0}},data(){return{drawing:!1,deg:0,prizeIndex:0,isFirstMove:!0}},computed:{listLength(){return this.list.length},rotateDeg(){return Number((360/this.listLength).toFixed(2))},contentWidth(){return this.width-40},fanBladeWidth(){let e=this.listLength,t=this.contentWidth,n=0,i=360/e;return n=t*Math.tan(i/2*Math.PI/180),this.listLength>2?n:n>t?t:n}},mounted(){this.skew&&(this.deg=-1*Math.floor(this.rotateDeg/2))},methods:{go(e){let t=Number(e)+1;t?t>=this.listLength?console.warn("奖品索引值大于奖品列表数量，请检查"):this.drawing||(this.drawing=!0,this.deg=this.deg+2160+(360-(t-this.prizeIndex)*this.rotateDeg),this.isFirstMove&&(this.deg+=Math.floor(this.rotateDeg/2),this.isFirstMove=!1),this.prizeIndex=t,setTimeout(()=>{this.drawing=!1,this.$emit("onend",this.list[e])},6e3)):console.warn("请传入中奖奖品在奖品列表中的索引")},onDraw(){this.$emit("onDraw")}}};n("d7f9");const re=O()(ce,[["render",le]]);var se=re;se.install=function(e){e.component(se.name,se)};const ae=[E,A,U,se],ue=function(e){ue.installed||ae.map(t=>e.component(t.name,t))};"undefined"!==typeof window&&window.Vue&&ue(window.Vue);var de={install:ue,LotteryGrid:E,LotteryList:A,SlotMachine:U,Turntable:se};t["default"]=de},f424:function(e,t,n){"use strict";n("4296")}})}));